5_2_2 커스터마이즈로 배포 간편화하기

- 커스터마이즈를 통한 배포는 kubctl에 구성돼 있는 매니페스트를 고정적으로 이용해야하는 기존 방식을 유연하게 변경
- 커스터마이즈는 yaml파일에 정의된 값을 사용자가 원하는 값으로 변경할 수 있어 직접 편집기 프로그램으로 일일이 수정하지 안하도 된다.
- 커스터마이즈는 kustomize 명령과 create 옵션으로 kustomization.yaml이라는 기본 매니페스트를 만들고, 이 파일에 변경해야 하는 값들을 적용
- build 욥션으로 변경할 내용이 적용된 최종 yaml 파일을 저장하거나 바로 실행되도록 지정

1. 커스터 마이즈로 MetalLb 한 번에 만들기
- MetalLB 0.9 버전 부터는 쿠버네티스에서 MetalLB를 구성할 때 컨트롤러와 에이전트인 스피커가 통신할 때 보안을 위해 쿠버네티스의 시크릿(Secret) 오브젝트를 사용
- 따라서 0.9 버전 부터는  매니페스트 방법만이 아닌 커스터마이즈 방법도 추가로 안내
- 커스터마이즈는 단순히 최종 매니페스트 생성을 도와주는 도구
- 커스터마이즈에는 컨피그맵을 리소스로 넣는 것이 아니라 내용만을 읽어 들일 수 있도록 하는 옵션을 제공
- 제너레이터라는 요소를 통해 읽어들인 컨피그맵을 등록
- 제너레이터는 컨피그맵이나 시크릿의 데이터만 입력하면 각 형식에 맞게 생성
- 커스터마이즈서는 이름에 해시를 추가로 적용해 구성 요소들의 중복을 방지
- MetalLB는 고정된 컨피그맵 이름을 읽도록 설계돼 있기 때문에 커스터 마이즈의 GeneratorOptions를 disableNameSuffixHash:true로 변경해 문제 해결